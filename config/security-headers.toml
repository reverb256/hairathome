# Security Headers Configuration
# OWASP Top 10 and ISO 27001 Compliance

[security-headers]

# HTTP Strict Transport Security (HSTS)
[hsts]
enabled = true
max-age = 31536000  # 1 year
include-subdomains = true
preload = true
preload-listed = false  # Submit to hstspreload.org

# Content Security Policy (CSP)
[csp]
enabled = true
policy = "default-src 'self'; script-src 'self' 'unsafe-inline' https://www.google.com https://www.gstatic.com https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com; img-src 'self' data: https://images.unsplash.com https://*.unsplash.com; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; upgrade-insecure-requests; block-all-mixed-content"
report-only = false
report-uri = "https://csp-report.hairathome.ca/api/csp-report"

# X-Frame-Options
[x-frame-options]
enabled = true
policy = "DENY"  # Options: DENY, SAMEORIGIN, ALLOW-FROM

# X-Content-Type-Options
[x-content-type-options]
enabled = true
policy = "nosniff"

# X-XSS-Protection
[x-xss-protection]
enabled = true
policy = "1; mode=block"

# Referrer Policy
[referrer-policy]
enabled = true
policy = "strict-origin-when-cross-origin"  # OWASP recommended

# Permissions Policy
[permissions-policy]
enabled = true
directives = [
    "geolocation=()",
    "microphone=()",
    "camera=()",
    "payment=()",
    "usb=()",
    "magnetometer=()",
    "gyroscope=()",
    "accelerometer=()",
    "fullscreen=(self)",
    "web-share=()",
    "ambient-light-sensor=()",
    "autoplay=(self)",
    "encrypted-media=(self)",
    "fullscreen=(self)",
    "geolocation=()",
    "microphone=()",
    "midi=()",
    "payment=()",
    "picture-in-picture=()",
    "speaker=()",
    "usb=()",
    "vr=()"
]

# Additional Security Headers

# Clear Site Data
[clear-site-data]
enabled = false  # Enable only on logout
data-types = ["cache", "cookies", "storage", "executionContexts"]

# Cross-Origin Embedder Policy
[coep]
enabled = true
policy = "require-corp"

# Cross-Origin Opener Policy
[coop]
enabled = true
policy = "same-origin"

# Cross-Origin Resource Policy
[corp]
enabled = true
policy = "same-origin"

# Expect-CT
[expect-ct]
enabled = true
max-age = 86400  # 24 hours
enforce = true
report-uri = "https://ct-report.hairathome.ca/api/ct-report"

# Feature Policy (Legacy)
[feature-policy]
enabled = false  # Use Permissions Policy instead
directives = []

# Server Header Removal
[server-header]
enabled = true
remove = true
custom-value = ""  # Leave empty to remove

# X-Powered-By Header Removal
[x-powered-by]
enabled = true
remove = true

# Public Key Pinning (Deprecated - use Expect-CT instead)
[public-key-pins]
enabled = false
max-age = 5184000  # 60 days
include-subdomains = true
sha256-pins = []
report-only = false
report-uri = ""

# Content-Type Options
[content-type-options]
enabled = true
nosniff = true

# Download Options
[download-options]
enabled = true
no-open = true

# X-Permitted-Cross-Domain-Policies
[x-permitted-cross-domain-policies]
enabled = true
policy = "none"

# X-Robots-Tag
[x-robots-tag]
enabled = true
directives = ["noindex", "nofollow", "nosnippet", "noarchive"]

# Environment-Specific Headers

[environments.development]
hsts-enabled = false
csp-report-only = true
debug-headers = true

[environments.staging]
hsts-enabled = true
csp-report-only = true
debug-headers = false

[environments.production]
hsts-enabled = true
csp-report-only = false
debug-headers = false

# Header Scoring and Monitoring
[header-scoring]
enabled = true
security-score-threshold = 80
missing-header-alerts = true
weak-header-alerts = true

# Automated Header Testing
[automated-testing]
enabled = true
test-frequency = "daily"
test-endpoints = [
    "https://hairathome.ca",
    "https://www.hairathome.ca"
]
security-scanner = "owasp-zap"

# Header Compliance
[compliance]
owasp-top-10 = true
iso-27001 = true
pci-dss = false
gdpr = true
ccpa = true
nist-csf = true

# Header Reporting
[reporting]
enabled = true
report-frequency = "weekly"
report-recipients = [
    "security@hairathome.ca",
    "devops@hairathome.ca"
]
dashboard-url = "https://security.hairathome.ca/dashboard"

# Header Updates and Maintenance
[maintenance]
auto-update = true
update-frequency = "monthly"
security-advisory-check = true
vulnerability-scan = true

# Custom Headers for Specific Routes

[[custom-headers]]
route = "/api/*"
headers = [
    { name = "X-Content-Type-Options", value = "nosniff" },
    { name = "X-Frame-Options", value = "DENY" },
    { name = "X-XSS-Protection", value = "1; mode=block" },
    { name = "Referrer-Policy", value = "strict-origin-when-cross-origin" },
    { name = "Cache-Control", value = "no-store, no-cache, must-revalidate" }
]

[[custom-headers]]
route = "/admin/*"
headers = [
    { name = "X-Frame-Options", value = "DENY" },
    { name = "Content-Security-Policy", value = "default-src 'self'; frame-ancestors 'none'" },
    { name = "Cache-Control", value = "no-store, no-cache, must-revalidate" }
]

[[custom-headers]]
route = "/assets/*"
headers = [
    { name = "Cache-Control", value = "public, max-age=31536000, immutable" },
    { name = "X-Content-Type-Options", value = "nosniff" }
]