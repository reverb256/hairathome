<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ if .Title }}{{ .Title }} - {{ end }}{{ .Site.Title }}</title>
    <meta name="description" content="{{ .Description | default .Site.Params.description }}">
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Critical CSS inline -->
    <style>
        /* Critical above-the-fold styles */
        *{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:'Poppins',sans-serif;line-height:1.6;color:#333;background-color:#fff}a{text-decoration:none;color:inherit}img{max-width:100%;height:auto}.container{max-width:1200px;margin:0 auto;padding:0 20px}header{position:fixed;top:0;left:0;width:100%;background:rgba(255,255,255,.95);backdrop-filter:blur(10px);z-index:1000;box-shadow:0 2px 10px rgba(0,0,0,.1)}.navbar{padding:1rem 0}.nav-container{max-width:1200px;margin:0 auto;padding:0 20px;display:flex;justify-content:space-between;align-items:center}.logo h2{color:#8e44ad;font-family:'Playfair Display',serif;font-size:1.8rem}.nav-menu{display:flex;gap:2rem}.nav-link{font-weight:500;transition:color .3s ease}.nav-link:hover{color:#8e44ad}.hamburger{display:none;flex-direction:column;cursor:pointer}.bar{width:25px;height:3px;background-color:#333;margin:3px 0;transition:.3s}.hero{min-height:100vh;display:flex;align-items:center;padding:0 20px;position:relative;background:linear-gradient(135deg,#f5f7fa 0%,#e4e7f1 100%)}.hero-content{flex:1;max-width:600px;z-index:2}.hero-content h1{font-size:3.5rem;font-weight:700;color:#2c3e50;margin-bottom:1.5rem;line-height:1.2;font-family:'Playfair Display',serif}.hero-content p{font-size:1.2rem;color:#555;margin-bottom:2rem}.hero-buttons{display:flex;gap:1rem;margin-top:2rem}.btn{display:inline-block;padding:12px 30px;border-radius:30px;font-weight:600;text-align:center;cursor:pointer;transition:all .3s ease;border:none;font-size:1rem}.btn-primary{background:#8e44ad;color:white}.btn-primary:hover{background:#7d3c98;transform:translateY(-2px);box-shadow:0 5px 15px rgba(142,68,173,.3)}.btn-secondary{background:transparent;color:#8e44ad;border:2px solid #8e44ad}.btn-secondary:hover{background:#8e44ad;color:white;transform:translateY(-2px)}.hero-image{flex:1;display:flex;justify-content:center;align-items:center}.hero-image img{border-radius:10px;box-shadow:0 20px 40px rgba(0,0,0,.15);width:100%;max-width:500px}@media (max-width:768px){.nav-menu{position:fixed;left:-100%;top:70px;flex-direction:column;background-color:white;width:100%;text-align:center;transition:.3s;box-shadow:0 10px 27px rgba(0,0,0,.05);padding:2rem 0}.nav-menu.active{left:0}.hamburger{display:flex}.hero{flex-direction:column;text-align:center;padding-top:100px;min-height:auto}.hero-content{margin-bottom:2rem;max-width:100%}.hero-content h1{font-size:2.5rem}.hero-buttons{justify-content:center}}
    </style>
    
    <!-- Font preload -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"></noscript>
    
    <!-- Font Awesome -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
    
    <!-- Main stylesheet (non-critical) -->
    <link rel="stylesheet" href="{{ .Site.BaseURL }}css/style.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="{{ .Site.BaseURL }}css/style.css"></noscript>
    
    <!-- SEO Meta Tags -->
    {{ if .Site.Params.seo.enableOpenGraph }}
    <meta property="og:title" content="{{ .Title | default .Site.Title }}">
    <meta property="og:description" content="{{ .Description | default .Site.Params.description }}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ .Permalink }}">
    <meta property="og:image" content="{{ .Site.BaseURL }}images/og-image.jpg">
    {{ end }}
    
    {{ if .Site.Params.seo.enableTwitterCards }}
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ .Title | default .Site.Title }}">
    <meta name="twitter:description" content="{{ .Description | default .Site.Params.description }}">
    <meta name="twitter:image" content="{{ .Site.BaseURL }}images/og-image.jpg">
    {{ end }}
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{{ .Site.BaseURL }}favicon.ico">
    
    <!-- JSON-LD Structured Data -->
    {{ if .Site.Params.seo.enableJsonLd }}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "name": "{{ .Site.Title }}",
      "description": "{{ .Site.Params.description }}",
      "url": "{{ .Site.BaseURL }}",
      "telephone": "{{ .Site.Params.phone }}",
      "email": "{{ .Site.Params.email }}",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Winnipeg",
        "addressRegion": "MB",
        "addressCountry": "CA"
      },
      "priceRange": "$25-300"
    }
    </script>
    {{ end }}
</head>
<body>
    {{ partial "header.html" . }}
    
    <main>
        {{ block "main" . }}{{ end }}
    </main>
    
    {{ partial "footer.html" . }}
    
    <!-- Scripts -->
    <script src="{{ .Site.BaseURL }}js/main.js" defer></script>
    
    {{ if .Site.Params.performance.enableLazyLoading }}
    <script>
        // Lazy loading for images
        if ('loading' in HTMLImageElement.prototype) {
            const images = document.querySelectorAll('img[loading="lazy"]');
            images.forEach(img => {
                img.src = img.dataset.src;
            });
        } else {
            // Fallback for browsers that don't support lazy loading
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js';
            document.body.appendChild(script);
        }
    </script>
    {{ end }}
</body>
</html>