<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ if .Title }}{{ .Title }} - {{ end }}{{ .Site.Title }}</title>
    <meta name="description" content="{{ .Description | default .Site.Params.description }}">
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Critical CSS inline -->
    <style>
        /* Critical above-the-fold styles with dark mode */
        :root{--bg-primary:#050505;--bg-secondary:#0a0a0a;--bg-tertiary:#0f0f0f;--bg-card:#080808;--text-primary:#ffffff;--text-secondary:#b8b8b8;--text-accent:#e8e8e8;--primary-color:#8e44ad;--primary-hover:#7d3c98;--border-color:#333333;--shadow-md:0 4px 8px rgba(0,0,0,.4);--gradient-hero:linear-gradient(135deg,#050505 0%,#0a0a0a 100%)}[data-theme=light]{--bg-primary:#fff;--bg-secondary:#f8f9fa;--bg-tertiary:#e9ecef;--bg-card:#fff;--text-primary:#333;--text-secondary:#555;--text-accent:#2c3e50;--border-color:#ddd;--shadow-md:0 4px 8px rgba(0,0,0,.15);--gradient-hero:linear-gradient(135deg,#f5f7fa 0%,#e4e7f1 100%)}*{margin:0;padding:0;box-sizing:border-box}html{scroll-behavior:smooth}body{font-family:'Poppins',sans-serif;line-height:1.6;color:var(--text-primary);background-color:var(--bg-primary);transition:background-color .3s ease,color .3s ease}a{text-decoration:none;color:inherit}img{max-width:100%;height:auto}.container{max-width:1200px;margin:0 auto;padding:0 20px}header{position:fixed;top:0;left:0;width:100%;background:var(--bg-card);backdrop-filter:blur(10px);z-index:1000;box-shadow:var(--shadow-md);border-bottom:1px solid var(--border-color)}.navbar{padding:1rem 0;padding-right:80px}.nav-container{max-width:1200px;margin:0 auto;padding:0 20px;display:flex;justify-content:space-between;align-items:center}.logo h2{color:var(--primary-color);font-family:'Playfair Display',serif;font-size:1.8rem}.nav-menu{display:flex;gap:2rem}.nav-link{font-weight:500;color:var(--text-secondary);transition:color .3s ease}.nav-link:hover{color:var(--primary-color)}.hamburger{display:none;flex-direction:column;cursor:pointer}.bar{width:25px;height:3px;background-color:var(--text-primary);margin:3px 0;transition:.3s}.theme-toggle{position:fixed;top:20px;right:20px;z-index:1001;background:var(--bg-card);border:1px solid var(--border-color);border-radius:50px;padding:8px 16px;display:flex;align-items:center;gap:8px;cursor:pointer;transition:all .3s ease;box-shadow:var(--shadow-md)}.theme-toggle:hover{transform:translateY(-2px)}.theme-toggle i{font-size:1.2rem;color:var(--primary-color)}.hero{min-height:100vh;display:flex;align-items:center;padding:0 20px;position:relative;background:var(--gradient-hero)}.hero-content{flex:1;max-width:600px;z-index:2}.hero-content h1{font-size:3.5rem;font-weight:700;color:var(--text-accent);margin-bottom:1.5rem;line-height:1.2;font-family:'Playfair Display',serif}.hero-content p{font-size:1.2rem;color:var(--text-secondary);margin-bottom:2rem}.hero-buttons{display:flex;gap:1rem;margin-top:2rem}.btn{display:inline-block;padding:12px 30px;border-radius:30px;font-weight:600;text-align:center;cursor:pointer;transition:all .3s ease;border:none;font-size:1rem}.btn-primary{background:var(--primary-color);color:white}.btn-primary:hover{background:var(--primary-hover);transform:translateY(-2px);box-shadow:0 5px 15px rgba(142,68,173,.3)}.btn-secondary{background:transparent;color:var(--primary-color);border:2px solid var(--primary-color)}.btn-secondary:hover{background:var(--primary-color);color:white;transform:translateY(-2px)}.hero-image{flex:1;display:flex;justify-content:center;align-items:center}.hero-image img{border-radius:10px;box-shadow:0 20px 40px rgba(0,0,0,.4);width:100%;max-width:500px}@media(max-width:768px){.navbar{padding-right:20px}.theme-toggle{top:15px;right:15px;padding:6px 12px}.theme-toggle span{display:none}.hero{flex-direction:column;text-align:center;padding:2rem 20px}.hero-content{max-width:100%}.hero-content h1{font-size:2.5rem}.hero-buttons{flex-direction:column;align-items:center}.btn{width:100%;max-width:300px;margin-bottom:1rem}.hamburger{display:flex}.nav-menu{position:fixed;left:-100%;top:70px;flex-direction:column;background-color:var(--bg-card);width:100%;text-align:center;transition:.3s;box-shadow:var(--shadow-md);border-top:1px solid var(--border-color)}.nav-menu.active{left:0}.nav-menu li{margin:1rem 0}}
    </style>
    
    <!-- Font preload -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"></noscript>
    
    <!-- Font Awesome -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
    
    <!-- Main stylesheet (non-critical) -->
    <link rel="stylesheet" href="/css/style.css" media="print" onload="this.media='all'">
    <noscript><link rel="stylesheet" href="/css/style.css"></noscript>
    
    <!-- SEO Meta Tags -->
    {{ if .Site.Params.seo.enableOpenGraph }}
    <meta property="og:title" content="{{ .Title | default .Site.Title }}">
    <meta property="og:description" content="{{ .Description | default .Site.Params.description }}">
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ .Permalink }}">
    <meta property="og:image" content="/images/og-image.jpg">
    {{ end }}
    
    {{ if .Site.Params.seo.enableTwitterCards }}
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ .Title | default .Site.Title }}">
    <meta name="twitter:description" content="{{ .Description | default .Site.Params.description }}">
    <meta name="twitter:image" content="/images/og-image.jpg">
    {{ end }}
    
    <!-- Theme Color for Mobile Browsers -->
    <meta name="theme-color" content="#050505">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/favicon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/favicon-512x512.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="shortcut icon" href="/favicon.ico">
    
    <!-- JSON-LD Structured Data -->
    {{ if .Site.Params.seo.enableJsonLd }}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "name": "{{ .Site.Title }}",
      "description": "{{ .Site.Params.description }}",
      "url": "/",
      "telephone": "{{ .Site.Params.phone }}",
      "email": "{{ .Site.Params.email }}",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Winnipeg",
        "addressRegion": "MB",
        "addressCountry": "CA"
      },
      "priceRange": "$25-300"
    }
    </script>
    {{ end }}
</head>
<body>
    {{ partial "header.html" . }}
    
    <main>
        {{ block "main" . }}{{ end }}
    </main>
    
    {{ partial "footer.html" . }}
    
    <!-- Scripts -->
    <script src="/js/main.js" defer></script>
    
    {{ if .Site.Params.performance.enableLazyLoading }}
    <script>
        // Lazy loading for images
        if ('loading' in HTMLImageElement.prototype) {
            const images = document.querySelectorAll('img[loading="lazy"]');
            images.forEach(img => {
                img.src = img.dataset.src;
            });
        } else {
            // Fallback for browsers that don't support lazy loading
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js';
            document.body.appendChild(script);
        }
    </script>
    {{ end }}
</body>
</html>